<template name="loginForm">
  <div class="at">
    {{#unless currentUser}}
      {{#if atfpwd}}
        <h3>Reset your Password</h3>
      {{/if}}
      {{#if atsgin}}
        {{#if otherLoginServices}}
          <div class="at-social">
            {{#each loginServices}}
              {{> atSocial}}
            {{/each}}
            {{#if passwordLoginService}}
              <div class="email-option">
                <strong class="line-thru or-sign-in">OR</strong>
              </div>
            {{/if}}
          </div>
        {{/if}}
        {{#unless otherLoginServices}}
          <div class="email-option">
            <h3>Sign In</h3>
          </div>
        {{/unless}}
      {{/if}}
      {{#if atsgup}}
        <h3>Create an Account</h3>
        <p class="at-signin-cta">If you already have an account <a href="#" id="at-sgin">sign in</a>.</p>
      {{/if}}
      {{#if overallError}}
        <div id="atError">
          <div class='alert alert-danger'>{{overallError}}</div>
        </div>
      {{/if}}
      {{#if result}}
        <div id="atResult">
          <div class='alert alert-success'>{{result}}</div>
        </div>
      {{/if}}
      {{#if passwordLoginService}}
        <form class="at-form">
          {{#each fields}}
            {{#if displayField}}
              <div class="row">
                <div class="large-12 columns">
                  {{#if displayFormLabels}}
                    <label class="{{#if hasError}}error{{/if}}">{{displayName}}
                      <input type="{{type}}" class="{{#if hasError}}error{{/if}}" id="AT_field_{{name}}" placeholder="{{placeholder}}">
                    </label>
                  {{else}}
                    <input type="{{type}}" class="{{#if hasError}}error{{/if}}" id="AT_field_{{name}}" placeholder="{{placeholder}}">
                  {{/if}}
                  {{#if hasError}}
                    <small class="error">{{errorText}}</small>
                  {{/if}}
                </div>
              </div>
            {{/if}}   
          {{/each}}
          {{#unless atfpwd}}
            <p><a href="#" id="at-fpwd">Forgot password?</a></p>
          {{/unless}}
          <div class="button" id="at-btn">{{buttonText}}</div>
        </form>
        {{#unless atsgup}}
          <p class="at-signup-cta">Don't have an account? <a href="#" id="at-sgup">Sign Up</a></p>
        {{/unless}}
      {{/if}}
    {{else}}
        <h3>Hi {{signedInAs}}</h3>
        <div class="at-social">
          {{#each loginServices}}
            {{> atSocial}}
          {{/each}}
        </div>
        <div class="row">
          <div class="small-5 small-centered columns">
            <div class="button expand" id="at-btn-logout">Logout</div>
          </div>
        </div>
    {{/unless}}    
  </div>
</template>



<template name='atSocial'>
  <button class="button {{disabled}}" id="at-{{this}}" name="{{this}}">
    {{#if unconfigured}}
        <i class="{{iconClass}}"></i> Configure {{capitalize this}}
    {{else}}
        {{#if currentUser}}
          <i class="{{iconClass}}"></i> Add {{capitalize this}}
        {{else}}
          <i class="{{iconClass}}"></i> Sign in with {{capitalize this}}
        {{/if}}
    {{/if}}
  </button>
</template>
